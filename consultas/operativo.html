<!doctype html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="/consultas/operativo.css" />
  <title>PZMWEB Enterprise :: Controle de Impostos</title>
</head>

<body>
  <header class="header-container">
    <div class="header-left">
      <h2>
        <a href="/consultas/operativo.html" class="mainmenu">
          PZMWEB Enterprise :: Controle de Impostos
        </a>
      </h2>
    </div>
    <div class="header-right">
      <img src="/grupopzm.png" alt="logo" class="logo" />
    </div>
  </header>

  <nav class="nav-container">
    <div class="nav-left">
      <div class="menu-item">
        Controles
        <div class="submenu">
          <a href="/modulos/index.html">Alterar Aplicativo</a>
          <a href="/modulos/divisão.html">Alterar Divisão</a>
        </div>
      </div>
      <span>Cadastros</span>
      <div class="menu-item">
        Operações
        <div class="submenu">
          <a href="/consultas/operativo.html">Checklist de Apurações de Impostos Operativo</a>
          <a href="/consultas/supervisor.html">Checklist de Apurações de Impostos Supervisor</a>
          <a href="/capaprocesso/capa-de-processo.html">Controle de Aprovação da Capa de Processo</a>
        </div>
      </div>
      <span>Processos</span>
      <span>Relatórios</span>
      <span>Gráficos</span>
      <span>Configurações</span>
      <span>Ajuda</span>
      <span><a class="sair" href="/login/login.html">Sair</a></span>
    </div>
    <div class="nav-right">
      <div class="toggle-switch">
        <label class="switch-label">
          <input type="checkbox" class="checkbox" />
          <span class="slider"></span>
        </label>
      </div>
      <div class="flags">
        <img src="https://flagcdn.com/16x12/br.png" alt="Português" title="Português" />
        <img src="https://flagcdn.com/16x12/es.png" alt="Español" title="Español" />
        <img src="https://flagcdn.com/16x12/gb.png" alt="English" title="English" />
      </div>
    </div>
  </nav>



  <div class="form-header">
    <h3>Consulta Controle de Apuração de Impostos - Operativo</h3>
  </div>

  <div class="painel-geral">
    <div class="card-filtros">
      <div class="linha-id-consulta" style="grid-column: 1 / -1; display: flex; align-items: flex-end; justify-content: space-between;">
        <div class="fitros-consulta" style="margin: 0;">
          <label>ID da Operação:</label>
          <div>
            <input type="text" placeholder="Digite o ID da operação" style="width: 380px;" />
          </div>
        </div>
        <button class="consulta">Consultar</button>
      </div>
      <div class="fitros-consulta">
        <label>Data Inicial:</label>
        <input type="date" value="2025-06-01" />
        <label><input type="checkbox" checked /> Listar Pendências dos últimos 5 dias</label>
      </div>
      <div class="fitros-consulta">
        <label>Data Final:</label>
        <input type="date" value="2025-06-30" />
      </div>
      <div class="fitros-consulta">
        <label style="margin-bottom: 10px;">Data Base:</label>
        <div class="grupo-opcoes">
          <label><input type="radio" name="data-base" />Vencimento</label><br>
          <label><input type="radio" name="data-base" />Data Prevista</label><br>
          <label><input type="radio" name="data-base" />Data Realizada</label>
        </div>
      </div>
      <div class="fitros-consulta">
        <label>Empresa:</label>
        <select>
          <option>Todos os itens</option>
        </select>
        <label><input type="checkbox" /> Filtrar Empresas Inativas</label>
      </div>
      <div class="fitros-consulta">
        <label>Estabelecimento:</label>
        <select>
          <option>Todos os itens</option>
        </select>
        <label><input type="checkbox" /> Filtrar Estabelecimentos Inativos</label>
      </div>
      <div class="fitros-consulta">
        <label>Esfera:</label>
        <select>
          <option>Todos os itens</option>
        </select>
      </div>
      <div class="fitros-consulta">
        <label>Imposto:</label>
        <select>
          <option>Todos os itens</option>
        </select>
      </div>
      <div class="fitros-consulta">
        <label>Estágios:</label>
        <select>
          <option>Todos os itens</option>
        </select>
      </div>
      <div class="fitros-consulta">
        <label>Classificação:</label>
        <select>
          <option>Todos os itens</option>
        </select>
      </div>
      <div class="fitros-consulta">
        <label>Responsável:</label>
        <select>
          <option>Todos os itens</option>
        </select>
        <label><input type="checkbox" /> Filtrar todos os registros sem responsável</label>
      </div>

      <div class="fitros-consulta">
        <label>Status:</label>
        <select>
          <option>Todos os itens</option>
        </select>
      </div>
      <div class="analiticos">
        <label><input type="checkbox" checked /> Analítico</label>
      </div>
    </div>

    <div class="card-grafico">
      <span class="titulo-grafico">Controle de Status</span>
      <canvas id="graficoFarol" width="300" height="260"></canvas>
    </div>
  </div>

  <div class="linha-legenda-botoes">
    <div class="legenda">
      <span class="complementar">Complementar</span>
      <span class="retificacao">Retificação</span>
      <span class="dentro-prazo">Dentro do Prazo</span>
      <span class="no-limite">Prazo no Limite</span>
      <span class="vencido">Atenção: Prazo Vencido</span>
      <span class="finalizado">Processo Finalizado</span>
      <span class="fora-prazo">Finalizado [Fora do Prazo]</span>
      <span class="todos-os-status">Todos os Status</span>
    </div>
    <div class="carregar-arquivos">
      <button class="archives">Carregar Arquivos</button>
      <button class="eventual">Criar Controle Eventual</button>
    </div>
  </div>

  <div class="quantidade">
    <div class="linha-total-paginacao">
      <div class="totalizadores">
        <span>Total de Registros: 8</span>
        <span>Total de Itens: 16</span>
        <span><a href="#" class="baixar-anexos" onclick="abrirModal()">Total de Anexos: 14</a></span>
      </div>

      <nav class="pagination-nav">
        <label class="pagination-select">
          <span>Exibir</span>
          <select>
            <option>10</option>
            <option>20</option>
            <option>50</option>
            <option>100</option>
          </select>
          <span>por página</span>
        </label>
        <button class="pagination-btn" title="Primeira página">&laquo;</button>
        <button class="pagination-btn" title="Página anterior">&lsaquo;</button>
        <input type="number" value="1" min="1" class="pagination-input" />
        <span class="pagination-total">de 5</span>
        <button class="pagination-btn" title="Próxima página">&rsaquo;</button>
        <button class="pagination-btn" title="Última página">&raquo;</button>
      </nav>
    </div>
  </div>

  <div class="imp-info">
    <table>
      <thead>
        <tr class="header-table">
          <th></th>
          <th>CNPJ</th>
          <th>Local</th>
          <th>Empresa</th>
          <th>Estabelecimento</th>
          <th>Categória</th>
          <th>Imposto</th>
          <th>Esfera</th>
          <th>Vencimento</th>
          <th>Mês</th>
          <th>Ano</th>
          <th>Descrição de Vencimento</th>
          <th>Mês de competência</th>
        </tr>
      </thead>
      <tbody>
        <tr class="header-table2">
          <th>Número da Operação</th>
          <th>Estágio</th>
          <th>Responsável</th>
          <th>Status</th>
          <th>Retificação</th>
          <th>Data Prevista</th>
          <th>Data Realizada</th>
          <th>Valor</th>
          <th>Resultado da Operação</th>
          <th>Local de Pagamento</th>
          <th>Forma de Quitação</th>
          <th>Contabilização Automática</th>
          <th>Anexos</th>
        </tr>

        <tr class="header-atv">
          <td colspan="1">
            <img src="/ChatGPT Image 3 de jul. de 2025, 20_13_58.png" alt="parameter" class="parameter" />
          <td><span>444.000.000/0004-04</span></td>
          <td>Belo Horizonte</td>
          <td>Grupo PZM Matriz</td>
          <td>Filial PZM - SP</td>
          <td>Comercial</td>
          <td>ICMS</td>
          <td>Estadual</td>
          <td>10</td>
          <td>07</td>
          <td>2025</td>
          <td>Imposto com vencimento todo dia 10</td>
          <td>06/2025</td>
          </td>
        </tr>
        <td>
          <div class="status-etapa">
            <input type="checkbox" name="checkbox" id="checkbox" /><span class="farol dentro-prazo" id="modalOpenButton"></span>
            <span>12222</span>
          </div>
        </td>
        <td><span>Apuração</span></td>
        <td>Damares Oliveira</td>
        <td>Pendente</td>
        <td>Original</td>
        <td>ICMS PZM 3030</td>
        <td>15/07/2025</td>
        <td>250,00</td>
        <td>Devedora</td>
        <td>Contas a Pagar</td>
        <td>Compensação</td>
        <td>Sim</td>
        <td>1</td>
        </tr>
        <tr>
          <td>
            <div class="status-etapa">
              <input type="checkbox" name="checkbox" id="checkbox" /><span class="farol finalizado" id="modalOpenButton"></span>
              <span>12222</span>
            </div>
          </td>
          <td><span>Pagamento</span></td>
          <td>Damares Oliveira</td>
          <td>Concluído</td>
          <td>Original</td>
          <td>ICMS PZM 3030</td>
          <td>15/07/2025</td>
          <td>250,00</td>
          <td>Devedora</td>
          <td>Contas a Pagar</td>
          <td>Compensação</td>
          <td>Sim</td>
          <td>1</td>
        </tr>

        <tr class="guia-eventual">
          <td>
            <div class="status-etapa">
              <input type="checkbox" name="checkbox" id="checkbox" /><span class="farol finalizado" id="modalOpenButton"></span>
              <span>12222</span>
            </div>
          </td>
          <td><span>Eventual</span></td>
          <td>Damares Oliveira</td>
          <td>Concluído</td>
          <td>Original</td>
          <td>ICMS PZM 3030</td>
          <td>15/07/2025</td>
          <td>250,00</td>
          <td>Devedora</td>
          <td>Contas a Pagar</td>
          <td>Compensação</td>
          <td>Sim</td>
          <td>1</td>
        </tr>
      </tbody>
    </table>

    <table>
      <thead>
        <tr class="header-table">
          <th></th>
          <th>CNPJ</th>
          <th>Local</th>
          <th>Empresa</th>
          <th>Estabelecimento</th>
          <th>Categória</th>
          <th>Imposto</th>
          <th>Esfera</th>
          <th>Vencimento</th>
          <th>Mês</th>
          <th>Ano</th>
          <th>Descrição de Vencimento</th>
          <th>Mês de competência</th>
        </tr>
      </thead>
      <tbody>
        <tr class="header-table2">
          <th>Número da Operação</th>
          <th>Estágio</th>
          <th>Responsável</th>
          <th>Status</th>
          <th>Retificação</th>
          <th>Data Prevista</th>
          <th>Data Realizada</th>
          <th>Valor</th>
          <th>Resultado da Operação</th>
          <th>Local de Pagamento</th>
          <th>Forma de Quitação</th>
          <th>Contabilização Automática</th>
          <th>Anexos</th>
        </tr>

        <tr class="header-atv">
          <td colspan="1">
            <img src="/ChatGPT Image 3 de jul. de 2025, 20_13_58.png" alt="parameter" class="parameter" />
          <td><span>444.000.000/0004-04</span></td>
          <td>Belo Horizonte</td>
          <td>Grupo PZM Matriz</td>
          <td>Filial PZM - SP</td>
          <td>Comercial</td>
          <td>ICMS</td>
          <td>Estadual</td>
          <td>10</td>
          <td>07</td>
          <td>2025</td>
          <td>Imposto com vencimento todo dia 10</td>
          <td>06/2025</td>
          </td>
        </tr>


        <td>
          <div class="status-etapa">
            <input type="checkbox" name="checkbox" id="checkbox" /><span class="farol dentro-prazo" id="modalOpenButton"></span>
            <span>12222</span>
          </div>
        </td>
        <td><span>Apuração</span></td>
        <td>Damares Oliveira</td>
        <td>Pendente</td>
        <td>Original</td>
        <td>ICMS PZM 3030</td>
        <td>15/07/2025</td>
        <td>2500,00</td>
        <td>Devedora</td>
        <td>Contas a Pagar</td>
        <td>Compensação</td>
        <td>Sim</td>
        <td>1</td>
        </tr>
        <tr>
          <td>
            <div class="status-etapa">
              <input type="checkbox" name="checkbox" id="checkbox" /><span class="farol finalizado" id="modalOpenButton"></span>
              <span>12222</span> +
            </div>
          </td>
          <td><span>Pagamento</span></td>
          <td>Damares Oliveira</td>
          <td>Pendente</td>
          <td>Original</td>
          <td>ICMS PZM 3030</td>
          <td>15/07/2025</td>
          <td>2500,00</td>
          <td>Devedora</td>
          <td>Contas a Pagar</td>
          <td>Compensação</td>
          <td>Sim</td>
          <td>1</td>
        </tr>

        <tr class="complementar">
          <td>
            <div class="status-etapa">
              <input type="checkbox" name="checkbox" id="checkbox" />
              <span>12222</span>
            </div>
          </td>
          <td><span>Complementar</span></td>
          <td>Damares Oliveira</td>
          <td>Concluído</td>
          <td>Original</td>
          <td>ICMS PZM 3030</td>
          <td>15/07/2025</td>
          <td>250,00</td>
          <td>Devedora</td>
          <td>Contas a Pagar</td>
          <td>Compensação</td>
          <td>Sim</td>
          <td>1</td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="helpFab" id="helpFab">
    <span>?</span>
  </div>

  <div class="chat-popup" id="chat-popup">
    <div class="chat-header">
      <span>Agente PZM</span>
      <button class="close-chat" onclick="toggleChat()">×</button>
    </div>
    <div class="chat-body" id="chat-body">
      <div class="message bot">Olá! Como posso te ajudar hoje?</div>
    </div>
    <div class="chat-input-area">
      <input type="text" id="user-input" placeholder="Digite sua mensagem..." />
      <button onclick="sendMessage()">Enviar</button>
    </div>
  </div>


  <div id="modalAnexos" class="modal">
    <div class="modal-conteudo">
      <span class="fechar" onclick="fecharModal()">&times;</span>
      <h2>Anexos do Checklist</h2>

      <div class="tabela-anexos">
        <div class="cabecalho">
          <span><input type="checkbox" /></span>
          <span>ID</span>
          <span>Empresa</span>
          <span>Estabelecimento</span>
          <span>Imposto</span>
          <span>Ano e Mês</span>
          <span>Tamanho</span>
          <span>Arquivo</span>
        </div>

        <div class="linha">
          <span><input type="checkbox" /></span>
          <span>22222</span>
          <span>ABC</span>
          <span>Matriz</span>
          <span>ICMS</span>
          <span>2025/07</span>
          <span>10GB</span>
          <span><a href="/anexos/anexo1.pdf" target="_blank">Comprovante.pdf</a></span>
        </div>

        <div class="linha">
          <span><input type="checkbox" /></span>
          <span>33333</span>
          <span>PZM</span>
          <span>Filial SP</span>
          <span>ISS</span>
          <span>2025/07</span>
          <span>3.4MB</span>
          <span><a href="/anexos/anexo2.jpg" target="_blank">Comprovante.jpg</a></span>
        </div>

        <div class="linha">
          <span><input type="checkbox" /></span>
          <span>44444</span>
          <span>XYZ</span>
          <span>Unidade RJ</span>
          <span>ICMS-ST</span>
          <span>2025/07</span>
          <span>790KB</span>
          <span><a href="/anexos/anexo3.xlsx" target="_blank">Planilha.xlsx</a></span>
        </div>

        <div class="linha">
          <span><input type="checkbox" /></span>
          <span>44444</span>
          <span>XYZ</span>
          <span>Unidade RJ</span>
          <span>ICMS-ST</span>
          <span>2025/07</span>
          <span>790KB</span>
          <span><a href="/anexos/anexo3.xlsx" target="_blank">Planilha.xlsx</a></span>
        </div>

        <div class="linha">
          <span><input type="checkbox" /></span>
          <span>44444</span>
          <span>XYZ</span>
          <span>Unidade RJ</span>
          <span>ICMS-ST</span>
          <span>2025/07</span>
          <span>790KB</span>
          <span><a href="/anexos/anexo3.xlsx" target="_blank">Planilha.xlsx</a></span>
        </div>

        <div class="linha">
          <span><input type="checkbox" /></span>
          <span>44444</span>
          <span>XYZ</span>
          <span>Unidade RJ</span>
          <span>ICMS-ST</span>
          <span>2025/07</span>
          <span>790KB</span>
          <span><a href="/anexos/anexo3.xlsx" target="_blank">Planilha.xlsx</a></span>
        </div>

        <div class="linha">
          <span><input type="checkbox" /></span>
          <span>44444</span>
          <span>XYZ</span>
          <span>Unidade RJ</span>
          <span>ICMS-ST</span>
          <span>2025/07</span>
          <span>790KB</span>
          <span><a href="/anexos/anexo3.xlsx" target="_blank">Planilha.xlsx</a></span>
        </div>

        <div class="linha">
          <span><input type="checkbox" /></span>
          <span>44444</span>
          <span>XYZ</span>
          <span>Unidade RJ</span>
          <span>ICMS-ST</span>
          <span>2025/07</span>
          <span>790KB</span>
          <span><a href="/anexos/anexo3.xlsx" target="_blank">Planilha.xlsx</a></span>
        </div>

        <div class="linha">
          <span><input type="checkbox" /></span>
          <span>44444</span>
          <span>XYZ</span>
          <span>Unidade RJ</span>
          <span>ICMS-ST</span>
          <span>2025/07</span>
          <span>790KB</span>
          <span><a href="/anexos/anexo3.xlsx" target="_blank">Planilha.xlsx</a></span>
        </div>

      </div>
      <button class="btn-download-todos">Baixar Todos</button>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>

  <script>
    function abrirModal() {
      document.getElementById("modalAnexos").style.display = "block";
    }

    function fecharModal() {
      document.getElementById("modalAnexos").style.display = "none";
    }

    window.onclick = function (event) {
      const modal = document.getElementById("modalAnexos");
      if (event.target === modal) {
        modal.style.display = "none";
      }
    };

    const helpFab = document.getElementById('helpFab');
    const chatPopup = document.getElementById('chat-popup');
    const chatBody = document.getElementById('chat-body');
    const userInput = document.getElementById('user-input');

    helpFab.onclick = function () {
      chatPopup.classList.add('show');
    };

    function toggleChat() {
      chatPopup.classList.remove('show');
    }

    window.addEventListener('mousedown', function (e) {
      if (chatPopup.classList.contains('show') && !chatPopup.contains(e.target) && e.target !== helpFab) {
        toggleChat();
      }
    });

    function appendMessage(content, sender) {
      const msg = document.createElement('div');
      msg.className = `message ${sender}`;
      msg.textContent = content;
      chatBody.appendChild(msg);
      chatBody.scrollTop = chatBody.scrollHeight;
    }

    const knowledgeBase = [
      {
        question: "Como cadastrar uma nova classe contábil?",
        answer: "Acesse: Cadastros > Auxiliares > Classe contábil.\n- Insira um código sequencial (não pode ser repetido).\n- Informe o nome da classe.\n- Informe o tipo (ativo, passivo ou resultado)."
      },
      {
        question: "Como cadastrar feriados no sistema?",
        answer: "Acesse: Operações > Auxiliares > Feriados.\n- Clique em Consultar para verificar os existentes.\n- Indique dia/mês/ano, marque esfera (Federal, Estadual ou Municipal), indique se é Permanente e clique em Confirmar."
      },
      {
        question: "Como resetar a senha?",
        answer: "Acesse o módulo de administração, vá em Configurações > Usuários > Consulte o usuário desejado.\n- Em seguida, clique no lápis para acessar a tela de cadastro do usuário.\n- Insira a senha 'Padrao998', ela irá gerar uma contra senha que será encaminhada ao usuário."
      },
      {
        question: "O que é checklist de partida?",
        answer: "Serve para associar responsáveis a novas contas. Sempre tem o mês zero (0) e não é usado para conciliação."
      },
      {
        question: "Como fazer carga em massa do plano de contas?",
        answer: "Acesse: Controle > Importar > Dados via CSV/TXT.\n- Clique em 'Escolher arquivo' e depois em 'Importar arquivo'."
      },
      {
        question: "Quais formatos de arquivo são aceitos para carga de anexos?",
        answer: "PDF, ZIP e RAR."
      },
      {
        question: "Como aprovar uma capa com ressalva?",
        answer: "Somente o aprovador contábil pode aprovar com ressalva. É necessário inserir uma justificativa e um motivo de ressalva."
      },
      {
        question: "O que é saldo extracontábil?",
        answer: "São registros financeiros que não afetam a contabilidade oficial, usados para controle gerencial."
      },
      {
        question: "Como validar um balancete?",
        answer: "Acesse: Controles > Base de dados > Validação Balancete. Selecione os saldos e clique em Validar e depois Inserir Dados."
      }
    ];

    const fuse = new Fuse(knowledgeBase, {
      keys: ['question'],
      threshold: 0.4
    });

    async function sendMessage() {
      const text = userInput.value.trim();
      if (!text) return;

      appendMessage(text, 'user');
      userInput.value = '';

      try {
        const response = await fetch('https://api.groq.com/openai/v1/chat/completions', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': 'Bearer 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'
          },
          body: JSON.stringify({
            model: 'mixtral-8x7b-32768',
            messages: [
              {
                role: 'system',
                content: 'Você é um assistente virtual da empresa PZM. Seja claro, direto e educado. Responda com base no manual.'
              },
              {
                role: 'user',
                content: text
              }
            ]
          })
        });

        const data = await response.json();
        const botReply = data.choices?.[0]?.message?.content;

        if (botReply) {
          appendMessage(botReply, 'bot');
        } else {
          const local = fuse.search(text);
          if (local.length > 0) {
            appendMessage(local[0].item.answer, 'bot');
          } else {
            appendMessage("Desculpe, não encontrei nada relacionado a isso no manual.", 'bot');
          }
        }
      } catch (error) {
        console.error(error);
        const local = fuse.search(text);
        if (local.length > 0) {
          appendMessage(local[0].item.answer, 'bot');
        } else {
          appendMessage("Erro ao se comunicar com a IA e não encontrei nada no manual.", 'bot');
        }
      }
    }

    userInput?.addEventListener("keypress", function (e) {
      if (e.key === "Enter") sendMessage();
    });
  </script>




</body>

</html>